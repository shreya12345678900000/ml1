import matplotlib.pyplot as plt
from sklearn.datasets import load_iris
from sklearn.externals.array_api_compat.numpy.linalg import solve
from sklearn.preprocessing import StandardScaler
from sklearn.neural_network import MLPClassifier
from sklearn.model_selection import train_test_split
from sklearn.metrics import  classification_report, confusion_matrix, accuracy_score
import seaborn as sns

from prog1 import X_train, y_train, scaler, y_pred

iris=load_iris()
X=iris.data
y=iris.target
X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.3,random_state=42)
scaler=StandardScaler()
x_train=scaler.fit_transform(X_train)
X_test=scaler.transform(X_test)
mlp=MLPClassifier(
    hidden_layer_sizes=(10,8),
    activation='relu',
    solver='adam',
    max_iter=500,
    random_state=42
)
mlp.fit(X_train,y_train)
y_pred=mlp.predict(X_test)
print("clasification report")
print( confusion_matrix(y_test,y_pred))
print("\nclassification report")
print(classification_report(y_test,y_pred,target_names=iris.target_names))
print("accuary:",accuracy_score(y_test,y_pred))
plt.figure(figsize=(6,4))
sns.heatmap(confusion_matrix(y_test,y_pred),annot=True,cmap="Blues",
            xticklabels=iris.target_names,yticklabels=iris.target_names)
plt.xlabel("pL")
plt.ylabel("TL")
plt.title("confusion matix-Ann")
plt.show()
